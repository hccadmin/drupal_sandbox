<?php
/**
 * Implements hook_init()
 */
function menu_active_trail_init() {
  //dpm(menu_tree('main-menu'));
  //$menus = menu_get_active_trail();
  //dpm($menus);
  //dpm(menu_get_active_trail());
  //dpm(menu_get_item());
  //dpm(menu_main_menu());
  //$trail = menu_get_active_trail();
  //dpm($trail);
  //$trail[1];
  //dpm(drupal_attributes($trail[2]));
  //$path = $_GET['q'];
  //dpm($path);
  //$menu_items = menu_tree('main-menu');
  /*
  foreach($menu_items as $num => $item) {
  	if(strstr($num, 'active-trail')) {
	  $item['attributes']['class'][] = 'active';
      dpm($item);
	  return;
	}
  }
  */
  //$menu_items[837]['#attributes']['class'][] = 'active';
  //dpm($menu_items);

  //$links = menu_load_links('main-menu');
  //dpm($links);
  //theme('menu_parent_activate', $links);
}

function menu_active_trail_process_links(&$links) {
  //dpm($links);
  //dpm(menu_get_active_trail());
  $items = menu_get_active_trail();
  if (count($items) > 2) {
    foreach($links as $link) {
	  foreach($link as $key => $value) {
	    if(preg_match('/active-trail/', $key) === 1) {
	      $value['title'] = 'This is another damn test';
		}
	  }
	}
    //activate_parent($items[count($items) - 2], $links);
  }
}


/*
function activate_parent($items, &$links) {
  $match = '/' . $items['mlid'] . '/';
  if (count($items) < 2) {
    return;
  }

  else {
    foreach($links as $link) {
	  if(count($link) > 1) {
		foreach($link as $key => $value) {
		  if( preg_match($match, $key ) === 1 ) {
			$value['attributes']['class'][] = 'active';
		  }
		}
      }
	}
  }
}
*/
 
/*
function menu_active_trail_preprocess_menu_link(&$links) {
  //dpm($links['element']);
  $activeTrail = menu_get_active_trail();
  foreach($links as $link) {
  	//dpm($link);
    if (isset($link['#original_link']) && 
	          $link['#original_link']['in_active_trail'] &&
	          $link['#original_link']['plid'] > 0) {
        dpm($link);
		//$parent = menu_link_load($link['#original_link']['plid']);
	}
  }
}
*/

/**
 * Implements hook_preprocess_menu_link().
function menu_active_trail_preprocess_menu_link(&$items) {
  dpm($items);
}
 */

/**
 * Implements hook_menu_alter().
 */
function menu_active_trail_menu_alter(&$link) {
  dpm($link);
}

